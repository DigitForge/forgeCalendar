<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
    <title>forgeCalendar</title>
    <link rel="stylesheet" type="text/css" href="/css/dforge.forgeCalendar.css">
</head>
<body>
    <div class="container">
        <div id="DayPlanner" class="calendar week"></div>
    </div>

    <script src="/js/jquery-1.9.1.js" type="text/javascript"></script>
    <script src="/js/moment.js" type="text/javascript"></script>
    <script src="/js/dforge.forgeCalendar.js" type="text/javascript"></script>
    <script type="text/javascript">

        function randomIntFromInterval(min, max) {
            return Math.floor(Math.random() * (max - min + 1) + min);
        }

        function createRandomEvents(startDate, endDate) {
            var items = [];
            for (var date = moment(startDate) ; date < moment(endDate) ; date = date.add("days", 1)) {
                var numEventsThisDay = randomIntFromInterval(5, 10);
                for (var i = 0; i < numEventsThisDay; i++) {
                    var hour = randomIntFromInterval(0, 23); // 12am to 11pm
                    var duration = 30 * randomIntFromInterval(1, 8); // 30 minutes to 4 hours
                    var start = moment(date).hour(hour).minute(0).millisecond(0); 
                    var item = {
                        Start: start,
                        End: moment(start).add("minutes",duration),
                        Name: "Random",
                    };
                    items.push(item);
                }
            }
            return items;
        }

        function createMultiDayEvents(startDate, endDate) {
            var items = [];
            var item = null;

            for (var date = moment(startDate) ; date < moment(endDate) ; date = date.add("days", 1)) {
                var start = null;
                var duration = null;

                //var start = moment(date).hour(22).minute(0).millisecond(0);
                //var duration = 60;
                //item = {
                //    Start: start,
                //    End: moment(start).add("minutes", duration),
                //    Name: "Random",
                //};
                //items.push(item);

                start = moment(date).hour(23).minute(0).millisecond(0);
                duration = 90;
                item = {
                    Start: start,
                    End: moment(start).add("minutes", duration),
                    Name: "Random",
                };
                items.push(item);

                start = moment(date).hour(23).minute(30).millisecond(0);
                duration = 90;
                item = {
                    Start: start,
                    End: moment(start).add("minutes", duration),
                    Name: "Random",
                };
                items.push(item);
            }
            return items;
        }

        function createSameTimeEvents(startDate, endDate) {
            var items = [];
            var item = null;

            for (var date = moment(startDate) ; date < moment(endDate) ; date = date.add("days", 1)) {
                var start = null;
                var duration = null;


                start = moment(date).hour(11).minute(0).millisecond(0);
                duration = 30;
                item = {
                    Start: start,
                    End: moment(start).add("minutes", duration),
                    Name: "Random",
                };
                items.push(item);


                start = moment(date).hour(7).minute(0).millisecond(0);
                duration = 60;
                item = {
                    Start: start,
                    End: moment(start).add("minutes", duration),
                    Name: "Random",
                };
                items.push(item);


                start = moment(date).hour(14).minute(0).millisecond(0);
                duration = 90;
                item = {
                    Start: start,
                    End: moment(start).add("minutes", duration),
                    Name: "Random",
                };
                items.push(item);

                start = moment(date).hour(13).minute(0).millisecond(0);
                duration = 210;
                item = {
                    Start: start,
                    End: moment(start).add("minutes", duration),
                    Name: "Random",
                };
                items.push(item);


                start = moment(date).hour(14).minute(0).millisecond(0);
                duration = 180;
                item = {
                    Start: start,
                    End: moment(start).add("minutes", duration),
                    Name: "Random",
                };
                items.push(item);

                start = moment(date).hour(14).minute(0).millisecond(0);
                duration = 60;
                item = {
                    Start: start,
                    End: moment(start).add("minutes", duration),
                    Name: "Random",
                };
                items.push(item);

                start = moment(date).hour(18).minute(0).millisecond(0);
                duration = 60;
                item = {
                    Start: start,
                    End: moment(start).add("minutes", duration),
                    Name: "Random",
                };
                items.push(item);

                start = moment(date).hour(6).minute(0).millisecond(0);
                duration = 240;
                item = {
                    Start: start,
                    End: moment(start).add("minutes", duration),
                    Name: "Random",
                };
                items.push(item);


                start = moment(date).hour(23).minute(0).millisecond(0);
                duration = 60;
                item = {
                    Start: start,
                    End: moment(start).add("minutes", duration),
                    Name: "Random",
                };
                items.push(item);

                start = moment(date).hour(6).minute(0).millisecond(0);
                duration = 240;
                item = {
                    Start: start,
                    End: moment(start).add("minutes", duration),
                    Name: "Random",
                };
                items.push(item);

                start = moment(date).hour(4).minute(0).millisecond(0);
                duration = 150;
                item = {
                    Start: start,
                    End: moment(start).add("minutes", duration),
                    Name: "Random",
                };
                items.push(item);

            }
            return items;
        }

        function createProblemEvents(startDate, endDate) {

            //var jsonData = "[{\"Start\":\"2014-03-03T02:00:00.000Z\",\"End\":\"2014-03-03T05:30:00.000Z\",\"Name\":\"Random\"},{\"Start\":\"2014-03-02T11:00:00.000Z\",\"End\":\"2014-03-02T14:30:00.000Z\",\"Name\":\"Random\"},{\"Start\":\"2014-03-02T17:00:00.000Z\",\"End\":\"2014-03-02T17:30:00.000Z\",\"Name\":\"Random\"},{\"Start\":\"2014-03-02T15:00:00.000Z\",\"End\":\"2014-03-02T17:30:00.000Z\",\"Name\":\"Random\"},{\"Start\":\"2014-03-02T06:00:00.000Z\",\"End\":\"2014-03-02T09:30:00.000Z\",\"Name\":\"Random\"},{\"Start\":\"2014-03-03T04:00:00.000Z\",\"End\":\"2014-03-03T06:30:00.000Z\",\"Name\":\"Random\"},{\"Start\":\"2014-03-02T18:00:00.000Z\",\"End\":\"2014-03-02T20:30:00.000Z\",\"Name\":\"Random\"},{\"Start\":\"2014-03-02T13:00:00.000Z\",\"End\":\"2014-03-02T14:30:00.000Z\",\"Name\":\"Random\"},{\"Start\":\"2014-03-02T12:00:00.000Z\",\"End\":\"2014-03-02T16:00:00.000Z\",\"Name\":\"Random\"},{\"Start\":\"2014-03-03T01:00:00.000Z\",\"End\":\"2014-03-03T04:30:00.000Z\",\"Name\":\"Random\"}]";
            //var data = JSON.parse(jsonData);

            //var sorter = function (a, b) { return new Date(a.Start) - new Date(b.Start); }
            ////return data.sort(sorter);
            //return data;

            //var jsonData = "[{\"options\":{\"startPropertyName\":\"Start\",\"endPropertyName\":\"End\",\"durationPropertyName\":\"Duration\"},\"item\":{\"Start\":\"2014-03-06T10:00:00.000Z\",\"End\":\"2014-03-06T11:00:00.000Z\",\"Name\":\"Random\"},\"_event\":{\"start\":\"2014-03-06T10:00:00.000Z\",\"end\":\"2014-03-06T11:00:00.000Z\",\"duration\":60},\"isBusy\":true,\"conflicts\":[]},{\"options\":{\"startPropertyName\":\"Start\",\"endPropertyName\":\"End\",\"durationPropertyName\":\"Duration\"},\"item\":{\"Start\":\"2014-03-06T11:00:00.000Z\",\"End\":\"2014-03-06T14:30:00.000Z\",\"Name\":\"Random\"},\"_event\":{\"start\":\"2014-03-06T11:00:00.000Z\",\"end\":\"2014-03-06T14:30:00.000Z\",\"duration\":210},\"isBusy\":true,\"conflicts\":[]},{\"options\":{\"startPropertyName\":\"Start\",\"endPropertyName\":\"End\",\"durationPropertyName\":\"Duration\"},\"item\":{\"Start\":\"2014-03-06T11:00:00.000Z\",\"End\":\"2014-03-06T12:30:00.000Z\",\"Name\":\"Random\"},\"_event\":{\"start\":\"2014-03-06T11:00:00.000Z\",\"end\":\"2014-03-06T12:30:00.000Z\",\"duration\":90},\"isBusy\":true,\"conflicts\":[]},{\"options\":{\"startPropertyName\":\"Start\",\"endPropertyName\":\"End\",\"durationPropertyName\":\"Duration\"},\"item\":{\"Start\":\"2014-03-06T11:00:00.000Z\",\"End\":\"2014-03-06T12:30:00.000Z\",\"Name\":\"Random\"},\"_event\":{\"start\":\"2014-03-06T11:00:00.000Z\",\"end\":\"2014-03-06T12:30:00.000Z\",\"duration\":90},\"isBusy\":true,\"conflicts\":[]},{\"options\":{\"startPropertyName\":\"Start\",\"endPropertyName\":\"End\",\"durationPropertyName\":\"Duration\"},\"item\":{\"Start\":\"2014-03-06T13:00:00.000Z\",\"End\":\"2014-03-06T14:00:00.000Z\",\"Name\":\"Random\"},\"_event\":{\"start\":\"2014-03-06T13:00:00.000Z\",\"end\":\"2014-03-06T14:00:00.000Z\",\"duration\":60},\"isBusy\":true,\"conflicts\":[]},{\"options\":{\"startPropertyName\":\"Start\",\"endPropertyName\":\"End\",\"durationPropertyName\":\"Duration\"},\"item\":{\"Start\":\"2014-03-06T19:00:00.000Z\",\"End\":\"2014-03-06T23:00:00.000Z\",\"Name\":\"Random\"},\"_event\":{\"start\":\"2014-03-06T19:00:00.000Z\",\"end\":\"2014-03-06T23:00:00.000Z\",\"duration\":240},\"isBusy\":true,\"conflicts\":[]},{\"options\":{\"startPropertyName\":\"Start\",\"endPropertyName\":\"End\",\"durationPropertyName\":\"Duration\"},\"item\":{\"Start\":\"2014-03-06T22:00:00.000Z\",\"End\":\"2014-03-07T01:00:00.000Z\",\"Name\":\"Random\"},\"_event\":{\"start\":\"2014-03-06T22:00:00.000Z\",\"end\":\"2014-03-07T01:00:00.000Z\",\"duration\":180},\"isBusy\":true,\"conflicts\":[]},{\"options\":{\"startPropertyName\":\"Start\",\"endPropertyName\":\"End\",\"durationPropertyName\":\"Duration\"},\"item\":{\"Start\":\"2014-03-07T01:00:00.000Z\",\"End\":\"2014-03-07T05:00:00.000Z\",\"Name\":\"Random\"},\"_event\":{\"start\":\"2014-03-07T01:00:00.000Z\",\"end\":\"2014-03-07T05:00:00.000Z\",\"duration\":240},\"isBusy\":true,\"conflicts\":[]},{\"options\":{\"startPropertyName\":\"Start\",\"endPropertyName\":\"End\",\"durationPropertyName\":\"Duration\"},\"item\":{\"Start\":\"2014-03-07T02:00:00.000Z\",\"End\":\"2014-03-07T04:00:00.000Z\",\"Name\":\"Random\"},\"_event\":{\"start\":\"2014-03-07T02:00:00.000Z\",\"end\":\"2014-03-07T04:00:00.000Z\",\"duration\":120},\"isBusy\":true,\"conflicts\":[]},{\"options\":{\"startPropertyName\":\"Start\",\"endPropertyName\":\"End\",\"durationPropertyName\":\"Duration\"},\"item\":{\"Start\":\"2014-03-07T03:00:00.000Z\",\"End\":\"2014-03-07T07:00:00.000Z\",\"Name\":\"Random\"},\"_event\":{\"start\":\"2014-03-07T03:00:00.000Z\",\"end\":\"2014-03-07T07:00:00.000Z\",\"duration\":240},\"isBusy\":true,\"conflicts\":[]}]";
            var jsonData = "[{\"options\":{\"startPropertyName\":\"Start\",\"endPropertyName\":\"End\",\"durationPropertyName\":\"Duration\"},\"item\":{\"Start\":\"2014-03-06T10:00:00.000Z\",\"End\":\"2014-03-06T11:00:00.000Z\",\"Name\":\"Random\"},\"_event\":{\"start\":\"2014-03-06T10:00:00.000Z\",\"end\":\"2014-03-06T11:00:00.000Z\",\"duration\":60},\"isBusy\":true,\"conflicts\":[]},{\"options\":{\"startPropertyName\":\"Start\",\"endPropertyName\":\"End\",\"durationPropertyName\":\"Duration\"},\"item\":{\"Start\":\"2014-03-06T11:00:00.000Z\",\"End\":\"2014-03-06T14:30:00.000Z\",\"Name\":\"Random\"},\"_event\":{\"start\":\"2014-03-06T11:00:00.000Z\",\"end\":\"2014-03-06T14:30:00.000Z\",\"duration\":210},\"isBusy\":true,\"conflicts\":[]},{\"options\":{\"startPropertyName\":\"Start\",\"endPropertyName\":\"End\",\"durationPropertyName\":\"Duration\"},\"item\":{\"Start\":\"2014-03-06T11:00:00.000Z\",\"End\":\"2014-03-06T12:30:00.000Z\",\"Name\":\"Random\"},\"_event\":{\"start\":\"2014-03-06T11:00:00.000Z\",\"end\":\"2014-03-06T12:30:00.000Z\",\"duration\":90},\"isBusy\":true,\"conflicts\":[]},{\"options\":{\"startPropertyName\":\"Start\",\"endPropertyName\":\"End\",\"durationPropertyName\":\"Duration\"},\"item\":{\"Start\":\"2014-03-06T11:00:00.000Z\",\"End\":\"2014-03-06T12:30:00.000Z\",\"Name\":\"Random\"},\"_event\":{\"start\":\"2014-03-06T11:00:00.000Z\",\"end\":\"2014-03-06T12:30:00.000Z\",\"duration\":90},\"isBusy\":true,\"conflicts\":[]},{\"options\":{\"startPropertyName\":\"Start\",\"endPropertyName\":\"End\",\"durationPropertyName\":\"Duration\"},\"item\":{\"Start\":\"2014-03-06T13:00:00.000Z\",\"End\":\"2014-03-06T14:00:00.000Z\",\"Name\":\"Random\"},\"_event\":{\"start\":\"2014-03-06T13:00:00.000Z\",\"end\":\"2014-03-06T14:00:00.000Z\",\"duration\":60},\"isBusy\":true,\"conflicts\":[]},{\"options\":{\"startPropertyName\":\"Start\",\"endPropertyName\":\"End\",\"durationPropertyName\":\"Duration\"},\"item\":{\"Start\":\"2014-03-06T19:00:00.000Z\",\"End\":\"2014-03-06T23:00:00.000Z\",\"Name\":\"Random\"},\"_event\":{\"start\":\"2014-03-06T19:00:00.000Z\",\"end\":\"2014-03-06T23:00:00.000Z\",\"duration\":240},\"isBusy\":true,\"conflicts\":[]},{\"options\":{\"startPropertyName\":\"Start\",\"endPropertyName\":\"End\",\"durationPropertyName\":\"Duration\"},\"item\":{\"Start\":\"2014-03-06T22:00:00.000Z\",\"End\":\"2014-03-07T01:00:00.000Z\",\"Name\":\"Random\"},\"_event\":{\"start\":\"2014-03-06T22:00:00.000Z\",\"end\":\"2014-03-07T01:00:00.000Z\",\"duration\":180},\"isBusy\":true,\"conflicts\":[]},{\"options\":{\"startPropertyName\":\"Start\",\"endPropertyName\":\"End\",\"durationPropertyName\":\"Duration\"},\"item\":{\"Start\":\"2014-03-07T01:00:00.000Z\",\"End\":\"2014-03-07T05:00:00.000Z\",\"Name\":\"Random\"},\"_event\":{\"start\":\"2014-03-07T01:00:00.000Z\",\"end\":\"2014-03-07T05:00:00.000Z\",\"duration\":240},\"isBusy\":true,\"conflicts\":[]},{\"options\":{\"startPropertyName\":\"Start\",\"endPropertyName\":\"End\",\"durationPropertyName\":\"Duration\"},\"item\":{\"Start\":\"2014-03-07T02:00:00.000Z\",\"End\":\"2014-03-07T04:00:00.000Z\",\"Name\":\"Random\"},\"_event\":{\"start\":\"2014-03-07T02:00:00.000Z\",\"end\":\"2014-03-07T04:00:00.000Z\",\"duration\":120},\"isBusy\":true,\"conflicts\":[]},{\"options\":{\"startPropertyName\":\"Start\",\"endPropertyName\":\"End\",\"durationPropertyName\":\"Duration\"},\"item\":{\"Start\":\"2014-03-07T03:00:00.000Z\",\"End\":\"2014-03-07T07:00:00.000Z\",\"Name\":\"Random\"},\"_event\":{\"start\":\"2014-03-07T03:00:00.000Z\",\"end\":\"2014-03-07T07:00:00.000Z\",\"duration\":240},\"isBusy\":true,\"conflicts\":[]}]";
            var data = JSON.parse(jsonData);
            var items = [];
            $.each(data, function (i, event) {
                var hour = moment(event.item.Start).hours();
                if(hour>=14 && hour <= 21)
                    items.push(event.item);
            });

            var sorter = function (a, b) { return new Date(a.Start) - new Date(b.Start); }
            //return items.sort(sorter);
            return items;
        }

        function initCalendar($container) {

            var startDate = moment().startOf("week")
            var endDate = moment().endOf("week");
            var data = createRandomEvents(startDate, endDate); //createProblemEvents(startDate, endDate); //createSameTimeEvents(startDate,endDate);  //createMultiDayEvents(startDate, endDate);

            $container.forgeCalendar({
                items: data,
                event: {
                    startPropertyName: "Start",
                    endPropertyName: "End",
                    durationPropertyName: "Duration",
                },
                display: {
                    startDate: moment().startOf("week"),
                    endDate: moment().endOf("week"),
                    //startHour: 9,
                    //endHour: 17,
                    daysOfWeek: [0, 1, 2, 3, 4, 5, 6], // list days of week to show for the specified time period, 0=SUN, 1=MON,....6=SAT
                },
                callbacks: {
                    onEventClicked: function (plugin, e, $event, event) {
                        alert("event clicked: " + event.start().format("llll"));
                    },
                    onFreeTimeClicked: function (plugin, e, $event, event, timeOfClick) {
                        alert("FreeTime: " + timeOfClick.format("llll"));
                    },
                    onHeaderClicked: function (plugin, e, $header, date) {
                        alert("Header: " + date.format("ddd, ll"));
                    },
                },
            });
        }
        $(document).ready(function () {
            initCalendar($("#DayPlanner"));
        });
    </script>


</body>

</html>
